{"link_serial":110,"update_time":"2017-12-14T16:05:18.054000+00:00","phase_snode_id":null,"scrub_version":"48f99abcdf450e7c49a04015355fb699f785e8cbf8288d894686a64c6caeddd1","instance_id":"c421e00d-7e6d-45dd-99be-390540124f83","update_user_id":"jskrable@bu.edu","class_fqid":"com-snaplogic-pipeline_8","partition_snode_id":"58c70e0fa87b6d76b3470f45","class_version":8,"snode_id":"5a329e51bba1200021034686","snap_map":{"7d93d49f-3041-47c1-acc7-566143d01199":{"instance_version":2,"class_id":"com-snaplogic-snaps-script-script","class_build_tag":"snapsmrc298","class_fqid":"com-snaplogic-snaps-script-script_2-snapsmrc298","instance_id":"7d93d49f-3041-47c1-acc7-566143d01199","property_map":{"info":{"notes":{"value":null},"label":{"value":"Sleep for 5 mins"}},"view_serial":100,"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"document"}}},"settings":{"editable_content":{"value":"# Import the interface required by the Script snap.\nfrom com.snaplogic.scripting.language import ScriptHook\nfrom time import sleep\n\nclass TransformScript(ScriptHook):\n    def __init__(self, input, output, error, log):\n        self.input = input\n        self.output = output\n        self.error = error\n        self.log = log\n\n    # The \"execute()\" method is called once when the pipeline is started\n    # and allowed to process its inputs or just send data to its outputs.\n    def execute(self):\n        self.log.info(\"Executing Transform script\")\n        while self.input.hasNext():\n            try:\n                # Read the next document, wrap it in a map and write out the wrapper\n                in_doc = self.input.next()\n                sleep(60)\n                self.output.write(in_doc)\n            except Exception as e:\n                errWrapper = {\n                    'errMsg' : str(e.args)\n                }\n                self.log.error(\"Error in python script\")\n                self.error.write(errWrapper)\n            \n        self.log.info(\"Finished executing the Transform script\")\n        \n# The Script Snap will look for a ScriptHook object in the \"hook\"\n# variable.  The snap will then call the hook's \"execute\" method.\nhook = TransformScript(input, output, error, log)"},"executable_during_suggest":{"value":false},"language":{"value":"Python"},"script":{"expression":false,"value":null}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":2,"instance_fqid":"7d93d49f-3041-47c1-acc7-566143d01199_2"},"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa":{"instance_version":1,"class_id":"com-snaplogic-snaps-transform-jsonsplitter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-jsonsplitter_1-snapsmrc405","instance_id":"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa","property_map":{"info":{"notes":{"value":null},"label":{"value":"JSON Filter Extraneous Data"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"nullSafeAccess":{"value":false},"includeParents":{"value":false},"includePaths":{"value":[]},"path":{"value":"$entity.response_map.entries"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":1,"instance_fqid":"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa_1"},"9f8f1834-e7ce-4a38-8433-caa1b4b28538":{"instance_version":1,"class_id":"com-snaplogic-snaps-rest-get","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-rest-get_2-snapsmrc405","instance_id":"9f8f1834-e7ce-4a38-8433-caa1b4b28538","property_map":{"info":{"notes":{"value":null},"label":{"value":"REST GET Log Data"}},"view_serial":101,"account":{"account_ref":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"retryInterval":{"value":3},"trustAllCerts":{"value":false},"retry":{"value":5},"hasNext":{"expression":true,"value":null},"timeout":{"value":900},"processArray":{"value":false},"nextUrl":{"expression":true,"value":null},"showAllHeaders":{"value":false},"paginationInterval":{"value":0},"executeDuringPreview":{"value":true},"header":{"value":[]},"responseEntityType":{"value":"DEFAULT"},"followRedirects":{"value":true},"serviceUrl":{"expression":true,"value":"'https://elastic.snaplogic.com/api/1/rest/public/log/' + pipe.projectPath.substring(1,pipe.projectPath.indexOf('/',1)) + '?'"},"queryParams":{"value":[{"queryParamValue":{"expression":true,"value":"$id"},"queryParam":{"value":"ruuid"}},{"queryParamValue":{"expression":true,"value":"'Error'"},"queryParam":{"value":"log_level"}}]},"rawData":{"value":false}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":2,"instance_fqid":"9f8f1834-e7ce-4a38-8433-caa1b4b28538_1"},"503b36c7-1b29-4a11-9f40-87730a546fa2":{"instance_version":1,"class_id":"com-snaplogic-snaps-transform-datatransform","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-datatransform_4-snapsmrc405","instance_id":"503b36c7-1b29-4a11-9f40-87730a546fa2","property_map":{"info":{"notes":{"value":null},"label":{"value":"Map Log Data to Document Disposition Columns"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"nullSafeAccess":{"value":true},"passThrough":{"value":false},"transformations":{"value":{"mappingTable":{"value":[{"expression":{"expression":true,"value":"$original.create_time"},"targetPath":{"value":"$create_time"}},{"expression":{"expression":true,"value":"$original.documents"},"targetPath":{"value":"$documents"}},{"expression":{"expression":true,"value":"$original.id"},"targetPath":{"value":"$id"}},{"expression":{"expression":true,"value":"$original.label"},"targetPath":{"value":"$label"}},{"expression":{"expression":true,"value":"$original.pipe_id"},"targetPath":{"value":"$pipe_id"}},{"expression":{"expression":true,"value":"$original.runtime_label"},"targetPath":{"value":"$runtime_label"}},{"expression":{"expression":true,"value":"jsonPath($, \"$entity.response_map.entries[*]._source.msg\").shift()"},"targetPath":{"value":"$error_msg"}}]},"mappingRoot":{"value":"$"}}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":4,"instance_fqid":"503b36c7-1b29-4a11-9f40-87730a546fa2_1"},"070e72e7-5732-413f-8be2-841db85dba4d":{"instance_version":1,"class_id":"com-snaplogic-snaps-rest-get","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-rest-get_2-snapsmrc405","instance_id":"070e72e7-5732-413f-8be2-841db85dba4d","property_map":{"info":{"notes":{"value":null},"label":{"value":"REST GET Monitoring Data from Last Hour"}},"view_serial":102,"account":{"account_ref":{"expression":false,"value":{}}},"settings":{"retryInterval":{"value":3},"trustAllCerts":{"value":true},"retry":{"value":5},"hasNext":{"expression":true,"value":"($entity.response_map.offset + $entity.response_map.limit) <  $entity.response_map.total"},"timeout":{"value":900},"processArray":{"value":false},"nextUrl":{"expression":true,"value":"'https://elastic.snaplogic.com/api/1/rest/public/runtime/' + pipe.projectPath.substring(1,pipe.projectPath.indexOf('/',1)) + '?last_hours=10&state=Failed&offset=' + ($entity.response_map.offset+$entity.response_map.limit)"},"showAllHeaders":{"value":false},"paginationInterval":{"value":0},"executeDuringPreview":{"value":true},"header":{"value":[]},"responseEntityType":{"value":"DEFAULT"},"followRedirects":{"value":true},"serviceUrl":{"expression":true,"value":"'https://elastic.snaplogic.com/api/1/rest/public/runtime/' + pipe.projectPath.substring(1,pipe.projectPath.indexOf('/',1))"},"connTimeout":{"value":30},"queryParams":{"value":[{"queryParamValue":{"expression":true,"value":"'Failed'"},"queryParam":{"value":"state"}},{"queryParamValue":{"expression":true,"value":"10"},"queryParam":{"value":"last_hours"}}]},"rawData":{"value":false}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"input":{"input102":{"view_type":{"value":"document"},"label":{"value":"input0"}}}},"class_version":2,"instance_fqid":"070e72e7-5732-413f-8be2-841db85dba4d_1"},"49d6afde-5261-4699-bb3d-7e4bd80b2b4f":{"instance_version":1,"class_id":"com-snaplogic-snaps-flow-datavalidator","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-flow-datavalidator_1-snapsmrc405","instance_id":"49d6afde-5261-4699-bb3d-7e4bd80b2b4f","property_map":{"info":{"notes":{"value":null},"label":{"value":"Ensure there is a failure to send"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"constraintMappings":{"value":[{"sourcePath":{"value":"$entity.response_map.total"},"constraintValue":{"value":"1"},"constraint":{"value":"Minimum"}}]}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"continue"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":1,"instance_fqid":"49d6afde-5261-4699-bb3d-7e4bd80b2b4f_1"},"e5412814-1e0e-4c92-9c12-48a00cfd70e1":{"instance_version":2,"class_id":"com-snaplogic-snaps-email-emailsender","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-email-emailsender_2-snapsmrc405","instance_id":"e5412814-1e0e-4c92-9c12-48a00cfd70e1","property_map":{"info":{"notes":{"value":null},"label":{"value":"Send email alert"}},"view_serial":103,"account":{"account_ref":{"expression":false,"value":{}}},"input":{"input101":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"body":{"expression":false,"value":"<!DOCTYPE html> \n<html> \n<head> \n<title>Email Snap HTML Table</title> \n<style type=\"text/css\"> table.Snap {background-color:transparent;border-collapse:collapse;width:100%;} table.Snap th, table.Snap td {text-align:center;border:1px solid black;padding:5px;} table.Snap th {background-color:AntiqueWhite;} </style> \n</head> \n<body> \n<p>Below is a summary of the failed snap(s)\n\n</p> \n<table class=\"Snap\"> </table> \n<p></p> \n<p>\nPlease log onto the  snapLogic Dashboard for further information</p> \n</body> \n</html>"},"retries":{"value":3},"from":{"expression":false,"value":"monitoring@snaplogic.budev.com"},"attachments":{"value":[{"url":{"expression":false,"value":null}}]},"cc":{"expression":false,"value":"somnatha@bu.edu, minhan@bu.edu, sdelano@bu.edu, tsemd@bu.edu"},"emailType":{"value":"HTML table"},"batchSize":{"value":100},"executable_during_suggest":{"value":false},"bcc":{"expression":false,"value":null},"to":{"expression":false,"value":"jskrable@bu.edu"},"tableDataPath":{"value":"$"},"passThrough":{"value":false},"subject":{"expression":true,"value":"'ERROR - Pipeline failure'"}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output103":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":2,"instance_fqid":"e5412814-1e0e-4c92-9c12-48a00cfd70e1_2"},"1b79fa33-6eb5-4e30-aa53-1035c53c5952":{"instance_version":2,"class_id":"com-snaplogic-snaps-flow-filter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-flow-filter_2-snapsmrc405","instance_id":"1b79fa33-6eb5-4e30-aa53-1035c53c5952","property_map":{"info":{"notes":{"value":null},"label":{"value":"Filter out records older than 5 minutes"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"filterExpression":{"expression":true,"value":"Date.now() - Date.parse($create_time) <= (1000 * 60)"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":2,"instance_fqid":"1b79fa33-6eb5-4e30-aa53-1035c53c5952_2"},"9df19d32-f76d-44a5-9192-6e351aabf731":{"instance_id":"9df19d32-f76d-44a5-9192-6e351aabf731","class_id":"com-snaplogic-snaps-flow-union","class_build_tag":"snapsmrc465","class_fqid":"com-snaplogic-snaps-flow-union_2-snapsmrc465","instance_version":1,"property_map":{"info":{"label":{"value":"Union"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}},"input1":{"view_type":{"value":"document"},"label":{"value":"input1"}}},"settings":{},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":2,"instance_fqid":"9df19d32-f76d-44a5-9192-6e351aabf731_1"}},"org_snode_id":"58c70e0ea87b6d76b3470f3e","path":"/BUDev/projects/JackSkrable/sendErrorNotificationLOOP","instance_version":7,"migrate_version":"master-2517","scrub_backup":[],"create_user_id":"jskrable@bu.edu","project_snode_id":"58ef9a4c44ecb472c109eb8b","property_map":{"info":{"notes":{"value":null},"label":{"value":"sendErrorNotificationLOOP"},"purpose":{"value":null},"pipeline_doc_uri":{"value":null},"author":{"value":"jskrable@bu.edu"}},"input":{"9df19d32-f76d-44a5-9192-6e351aabf731_input0":{"label":{"value":"Union - input0"},"view_type":{"value":"document"}}},"settings":{"imports":{"value":[]},"error_param_table":{"value":[]},"param_table":{"value":[]},"error_pipeline":{"expression":false,"value":null}},"instance_version":6,"error":{"error_behavior":{"value":"none"},"49d6afde-5261-4699-bb3d-7e4bd80b2b4f_error0":{"label":{"value":"Ensure there is a failure to send - error0"},"view_type":{"value":"document"}}},"output":{}},"render_map":{"pan_x_num":0,"default_snaplex":"58c70e13050186404b38dff2","scale_ratio":1,"detail_map":{"7d93d49f-3041-47c1-acc7-566143d01199":{"grid_x_int":1,"rot_int":0,"grid_y_int":3,"rot_tail_int":270},"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa":{"grid_x_int":5,"grid_y_int":2,"rot_tail_int":0,"output":{},"input":{},"rot_int":0},"9df19d32-f76d-44a5-9192-6e351aabf731":{"grid_x_int":2,"grid_y_int":2,"rot_tail_int":0,"output":{},"input":{"input1":{"dx_int":0,"rot_int":0,"dy_int":1}},"rot_int":0},"503b36c7-1b29-4a11-9f40-87730a546fa2":{"grid_x_int":8,"grid_y_int":2,"rot_tail_int":0,"output":{},"input":{},"rot_int":0},"070e72e7-5732-413f-8be2-841db85dba4d":{"grid_x_int":3,"rot_int":0,"grid_y_int":2,"rot_tail_int":0},"49d6afde-5261-4699-bb3d-7e4bd80b2b4f":{"grid_x_int":4,"error":{"error0":{"dx_int":0,"rot_int":0,"dy_int":-1}},"grid_y_int":2,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"e5412814-1e0e-4c92-9c12-48a00cfd70e1":{"grid_x_int":9,"rot_int":90,"grid_y_int":2,"rot_tail_int":0},"1b79fa33-6eb5-4e30-aa53-1035c53c5952":{"grid_x_int":6,"rot_int":0,"grid_y_int":2,"rot_tail_int":0},"9f8f1834-e7ce-4a38-8433-caa1b4b28538":{"grid_x_int":7,"grid_y_int":2,"rot_tail_int":0,"output":{},"input":{},"rot_int":0}},"pan_y_num":0},"org_id":"58c70e0ea87b6d76b3470f3e","path_id":"/BUDev/projects/JackSkrable","class_id":"com-snaplogic-pipeline","create_time":"2017-12-14T15:52:47.477000+00:00","instance_fqid":"c421e00d-7e6d-45dd-99be-390540124f83_7","link_map":{"link108":{"src_view_id":"output0","dst_view_id":"input102","src_id":"9df19d32-f76d-44a5-9192-6e351aabf731","dst_id":"070e72e7-5732-413f-8be2-841db85dba4d"},"link109":{"src_view_id":"output0","dst_view_id":"input1","src_id":"7d93d49f-3041-47c1-acc7-566143d01199","dst_id":"9df19d32-f76d-44a5-9192-6e351aabf731"},"link107":{"src_view_id":"output103","dst_view_id":"input0","src_id":"e5412814-1e0e-4c92-9c12-48a00cfd70e1","dst_id":"7d93d49f-3041-47c1-acc7-566143d01199"},"link104":{"src_view_id":"output0","dst_view_id":"input101","src_id":"503b36c7-1b29-4a11-9f40-87730a546fa2","dst_id":"e5412814-1e0e-4c92-9c12-48a00cfd70e1"},"link105":{"src_view_id":"output0","dst_view_id":"input0","src_id":"49d6afde-5261-4699-bb3d-7e4bd80b2b4f","dst_id":"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa"},"link102":{"src_view_id":"output0","dst_view_id":"input0","src_id":"070e72e7-5732-413f-8be2-841db85dba4d","dst_id":"49d6afde-5261-4699-bb3d-7e4bd80b2b4f"},"link103":{"src_view_id":"output0","dst_view_id":"input0","src_id":"eef9ae0c-3037-4b4f-b836-2e57b77b3eaa","dst_id":"1b79fa33-6eb5-4e30-aa53-1035c53c5952"},"link100":{"src_view_id":"output101","dst_view_id":"input0","src_id":"9f8f1834-e7ce-4a38-8433-caa1b4b28538","dst_id":"503b36c7-1b29-4a11-9f40-87730a546fa2"},"link101":{"src_view_id":"output0","dst_view_id":"input0","src_id":"1b79fa33-6eb5-4e30-aa53-1035c53c5952","dst_id":"9f8f1834-e7ce-4a38-8433-caa1b4b28538"}},"original":{"partition_snode_id":"58c70e0fa87b6d76b3470f45","updated_by":"jskrable@bu.edu","perms":["A","R","W","X"],"time_created":"2017-12-14T15:52:49.027000+00:00","snode_id":"5a329e51bba1200021034686","owner":"jskrable@bu.edu","path":"/BUDev/projects/JackSkrable/sendErrorNotificationLOOP","asset_type":"Pipeline","asset_id":"c421e00d-7e6d-45dd-99be-390540124f83","time_updated":"2017-12-14T16:05:18.054000+00:00","name":"sendErrorNotificationLOOP","parent_snode_id":"58ef9a4c44ecb472c109eb8b","acl":[],"metadata":{},"original":{"partition_snode_id":"58c70e0fa87b6d76b3470f45","updated_by":"jskrable@bu.edu","perms":["A","R","W","X"],"time_created":"2017-04-13T15:33:32.442000+00:00","snode_id":"58ef9a4c44ecb472c109eb8b","owner":"jskrable@bu.edu","path":"/BUDev/projects/JackSkrable","asset_type":"Dir","asset_id":null,"time_updated":"2017-11-20T20:07:13.490000+00:00","name":"JackSkrable","parent_snode_id":"58c70e0fa87b6d76b3470f45","acl":[{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"jskrable@bu.edu"},{"perms":["R","X"],"subject_type":"USER","inherit":true,"subject":"wlobao@bu.edu"},{"perms":["R","X"],"subject_type":"USER","inherit":true,"subject":"tsemd@bu.edu"},{"perms":["R","X"],"subject_type":"USER","inherit":true,"subject":"mvyravan@bu.edu"}],"metadata":{"pattern":false},"original":{"partition_snode_id":"5a1eba684503bf001e5a19c6","updated_by":"sdelano@bu.edu","perms":["A","R","W","X"],"time_created":"2017-03-13T21:24:31.092000+00:00","snode_id":"58c70e0fa87b6d76b3470f45","owner":"sdelano1@comcast.net","path":"/BUDev/projects","asset_type":"Dir","asset_id":null,"time_updated":"2017-11-03T14:40:52.927000+00:00","name":"projects","parent_snode_id":"58c70e0ea87b6d76b3470f3e","acl":[{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"admin@snaplogic.com"},{"perms":["R"],"subject_type":"GROUP","inherit":false,"subject":"members"},{"perms":["R"],"subject_type":"USER","inherit":false,"subject":"mvyravan@bu.edu"},{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"sdelano1@comcast.net"},{"perms":["R","X","W"],"subject_type":"GROUP","inherit":false,"subject":"Developers"}],"metadata":{}}}}}