{"link_serial":146,"update_time":"2017-12-14T21:34:19.041000+00:00","phase_snode_id":null,"scrub_version":"48f99abcdf450e7c49a04015355fb699f785e8cbf8288d894686a64c6caeddd1","update_user_id":"tsemd@bu.edu","class_fqid":"com-snaplogic-pipeline_8","partition_snode_id":"58c70e0fa87b6d76b3470f45","path_id":"/BUDev/projects/JackSkrable_testPull","class_version":8,"snode_id":"5a32ee5b67ad1a001f1ce1ed","snap_map":{"452173e2-4a8b-406f-8751-432ecb19ab8c":{"instance_id":"452173e2-4a8b-406f-8751-432ecb19ab8c","class_id":"com-snaplogic-snaps-binary-write","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-binary-write_3-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"File Writer"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{}}},"input":{"input0":{"view_type":{"value":"binary"},"label":{"value":"input0"}}},"settings":{"createDir":{"value":false},"writeHeader":{"value":false},"executable_during_suggest":{"value":false},"filename":{"expression":true,"value":"\"daily_totals_by_org_\" + Date.now().getMonth().toString() + \"_\" + Date.now().getDate().toString() + \"_\" + Date.now().getFullYear().toString().substring(2,4) + \".csv\""},"writeEmptyFile":{"value":false},"UserPermissionsKey":{"value":[]},"validate":{"value":false},"fileAction":{"value":"OVERWRITE"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":3,"instance_fqid":"452173e2-4a8b-406f-8751-432ecb19ab8c_1"},"0739e737-4439-480f-a761-bc1c0b4f637f":{"instance_id":"0739e737-4439-480f-a761-bc1c0b4f637f","class_id":"com-snaplogic-snaps-transform-csvformatter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-csvformatter_3-snapsmrc405","instance_version":1,"property_map":{"info":{"label":{"value":"CSV Formatter"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"quoteMode":{"value":"ALL"},"quoteCharacter":{"value":"\""},"writeHeader":{"value":true},"charset":{"value":"UTF-8"},"ignoreEmptyStream":{"value":false},"delimiter":{"value":","},"newlineCharacter":{"value":"LF"},"useDefinedHeader":{"value":false}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"binary"},"label":{"value":"output0"}}}},"class_version":3,"instance_fqid":"0739e737-4439-480f-a761-bc1c0b4f637f_1"},"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4":{"instance_id":"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4","class_id":"com-snaplogic-snaps-binary-write","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-binary-write_3-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"File Writer"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{}}},"settings":{"createDir":{"value":false},"writeHeader":{"value":false},"executable_during_suggest":{"value":false},"filename":{"expression":true,"value":"\"summaries_by_hour_\" + Date.now().getMonth().toString() + \"_\" + Date.now().getDate().toString() + \"_\" + Date.now().getFullYear().toString().substring(2,4) + \".csv\""},"writeEmptyFile":{"value":false},"UserPermissionsKey":{"value":[]},"validate":{"value":false},"fileAction":{"value":"OVERWRITE"}},"output":{"output101":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"binary"}}}},"class_version":3,"instance_fqid":"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4_1"},"8d692fb7-6483-4cfc-9608-c4ea5c0b3083":{"instance_id":"8d692fb7-6483-4cfc-9608-c4ea5c0b3083","class_id":"com-snaplogic-snaps-binary-write","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-binary-write_3-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"File Writer"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{}}},"input":{"input0":{"view_type":{"value":"binary"},"label":{"value":"input0"}}},"settings":{"createDir":{"value":false},"writeHeader":{"value":false},"executable_during_suggest":{"value":false},"filename":{"expression":true,"value":"\"daily_errors_by_type_\" + Date.now().getMonth().toString() + \"_\" + Date.now().getDate().toString() + \"_\" + Date.now().getFullYear().toString().substring(2,4) + \".csv\""},"writeEmptyFile":{"value":false},"UserPermissionsKey":{"value":[]},"validate":{"value":false},"fileAction":{"value":"OVERWRITE"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":3,"instance_fqid":"8d692fb7-6483-4cfc-9608-c4ea5c0b3083_1"},"28c07206-4b11-409b-a14c-f26841c8ab50":{"instance_id":"28c07206-4b11-409b-a14c-f26841c8ab50","class_id":"com-snaplogic-snaps-transform-csvformatter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-csvformatter_3-snapsmrc405","instance_version":1,"property_map":{"info":{"label":{"value":"CSV Formatter"}},"view_serial":100,"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"document"}}},"settings":{"quoteMode":{"value":"ALL"},"quoteCharacter":{"value":"\""},"writeHeader":{"value":true},"charset":{"value":"UTF-8"},"ignoreEmptyStream":{"value":false},"delimiter":{"value":","},"newlineCharacter":{"value":"LF"},"useDefinedHeader":{"value":false}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"output0"},"view_type":{"value":"binary"}}}},"class_version":3,"instance_fqid":"28c07206-4b11-409b-a14c-f26841c8ab50_1"},"fe51e887-dfbb-469a-bfd4-ec9ddf79f685":{"instance_version":1,"class_id":"com-snaplogic-snaps-transform-csvformatter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-csvformatter_3-snapsmrc405","instance_id":"fe51e887-dfbb-469a-bfd4-ec9ddf79f685","property_map":{"info":{"label":{"value":"CSV Formatter"}},"view_serial":100,"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"document"}}},"settings":{"quoteMode":{"value":"ALL"},"quoteCharacter":{"value":"\""},"writeHeader":{"value":true},"charset":{"value":"UTF-8"},"ignoreEmptyStream":{"value":false},"delimiter":{"value":","},"newlineCharacter":{"value":"LF"},"useDefinedHeader":{"value":false}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"label":{"value":"output0"},"view_type":{"value":"binary"}}}},"class_version":3,"instance_fqid":"fe51e887-dfbb-469a-bfd4-ec9ddf79f685_1"},"f424d299-359c-4c5d-bf05-6aee3a88d8ed":{"instance_id":"f424d299-359c-4c5d-bf05-6aee3a88d8ed","class_id":"com-snaplogic-snaps-mysql-execute","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-mysql-execute_1-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"MySQL - Execute"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{"ref_id":{"expression":false,"value":"33acbc3d-bff7-4b21-8071-4f7c66d27651"},"ref_class_id":{"value":"com-snaplogic-snap-api-sql-accounts-mysqldatabaseaccount"},"label":{"expression":false,"value":"jskrable Aurora"}}}},"settings":{"autoCommit":{"value":"Use account setting"},"passThrough":{"value":true},"ignoreEmptyResult":{"value":false},"executable_during_suggest":{"value":true},"sqlStatement":{"expression":false,"value":"SELECT CONVERT(A.End_Time, DATE)\n          AS Date,\n       CASE WHEN B.internalProcessed IS NULL THEN 0 ELSE B.internalProcessed END\n          AS 'Internal Docs Processed',\n       CASE WHEN C.publicProcessed IS NULL THEN 0 ELSE C.publicProcessed END\n          AS 'Public Docs Processed',\n       CASE WHEN D.restrictedProcessed IS NULL THEN 0 ELSE D.restrictedProcessed END\n          AS 'Restricted Docs Processed',\n       CASE WHEN E.confidentialProcessed IS NULL THEN 0 ELSE E.confidentialProcessed END\n          AS 'Confidential Docs Processed'\t\t\nFROM Integration_Run A\n     LEFT OUTER JOIN\n     (SELECT a.Start_Time,\n             SUM(a.Record_Count) AS internalProcessed,\n             b.Data_Classification,\n\t\t   a.Integration_ID\n      FROM Integration_Run a\n           INNER JOIN Integration_Descriptor b\n              ON a.Integration_ID = b.Integration_ID\n      WHERE b.Data_Classification = 'Internal'\n      GROUP BY convert(a.Start_Time, date)) B\n        ON CONVERT(A.End_Time, DATE)=convert(B.Start_Time, date)\n     LEFT OUTER JOIN\n     (SELECT a.Start_Time,\n             SUM(a.Record_Count) AS publicProcessed,\n             b.Data_Classification,\n\t\t   a.Integration_ID\n      FROM Integration_Run a\n           INNER JOIN Integration_Descriptor b\n              ON a.Integration_ID = b.Integration_ID\n      WHERE b.Data_Classification = 'Public'\n      GROUP BY convert(a.Start_Time, date)) C\n        ON CONVERT(A.End_Time, DATE)=convert(C.Start_Time, date)\n     LEFT OUTER JOIN\n     (SELECT a.Start_Time,\n             SUM(a.Record_Count) AS restrictedProcessed,\n             b.Data_Classification,\n\t\t   a.Integration_ID\n      FROM Integration_Run a\n           INNER JOIN Integration_Descriptor b\n              ON a.Integration_ID = b.Integration_ID\n      WHERE b.Data_Classification = 'Restricted'\n      GROUP BY convert(a.Start_Time, date)) D\n        ON CONVERT(A.End_Time, DATE)=convert(D.Start_Time, date)\n     LEFT OUTER JOIN\n     (SELECT a.Start_Time,\n             SUM(a.Record_Count) AS confidentialProcessed,\n             b.Data_Classification,\n\t\t   a.Integration_ID\n      FROM Integration_Run a\n           INNER JOIN Integration_Descriptor b\n              ON a.Integration_ID = b.Integration_ID\n      WHERE b.Data_Classification = 'Confidential'\n      GROUP BY convert(a.Start_Time, date)) E\n        ON CONVERT(A.End_Time, DATE)=convert(E.Start_Time, date)\nWHERE A.Status != 'Failed'\nGROUP BY CONVERT(A.End_Time, DATE)\nORDER BY CONVERT(A.End_Time, DATE) desc;"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":1,"instance_fqid":"f424d299-359c-4c5d-bf05-6aee3a88d8ed_1"},"b5129692-92ea-4d67-9e3b-5bf5f96dae67":{"instance_id":"b5129692-92ea-4d67-9e3b-5bf5f96dae67","class_id":"com-snaplogic-snaps-mysql-execute","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-mysql-execute_1-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"MySQL - Execute"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{"label":{"expression":false,"value":"jskrable Aurora"},"ref_class_id":{"value":"com-snaplogic-snap-api-sql-accounts-mysqldatabaseaccount"},"ref_id":{"expression":false,"value":"33acbc3d-bff7-4b21-8071-4f7c66d27651"}}}},"settings":{"autoCommit":{"value":"Use account setting"},"passThrough":{"value":true},"ignoreEmptyResult":{"value":false},"executable_during_suggest":{"value":true},"sqlStatement":{"expression":false,"value":"SELECT DATE_ADD(convert(A.End_Time, date),\n                INTERVAL hour(A.End_Time) HOUR)\n          AS Timestamp,\n       count(Run_Key)\n          AS \"Number of Integrations\",\n\t  CASE WHEN C.successes / (B.fails + C.successes) is null THEN '1.0'\n\t  ELSE C.successes / (B.fails + C.successes) END AS successRate,\n\t  -- avg(CAST(A.End_Time AS TIME)),\n\t  -- avg(CAST(A.Start_Time AS TIME)),\n       avg(convert((A.End_Time - A.Start_Time), time))\n          AS \"Average Duration (seconds)\",\n       sum(A.Record_Count)\n          AS \"Records Processed\"\nFROM Integration_Run A\n     LEFT OUTER JOIN\n     (SELECT COUNT(Record_Count) AS 'Fails', End_Time\n      FROM Integration_Run\n      WHERE Status = 'Failed'\n      GROUP BY DATE_ADD(convert(End_Time, date),\n                        INTERVAL hour(End_Time) HOUR)) B\n        ON DATE_ADD(convert(A.End_Time, date),\n                    INTERVAL hour(A.End_Time) HOUR) =\n           DATE_ADD(convert(B.End_Time, date),\n                    INTERVAL hour(B.End_Time) HOUR)\n\tLEFT OUTER JOIN\n     (SELECT COUNT(Record_Count) AS 'successes', End_Time\n      FROM Integration_Run\n      WHERE Status = 'Completed'\n      GROUP BY DATE_ADD(convert(End_Time, date),\n                        INTERVAL hour(End_Time) HOUR)) C\n        ON DATE_ADD(convert(A.End_Time, date),\n                    INTERVAL hour(A.End_Time) HOUR) =\n           DATE_ADD(convert(C.End_Time, date),\n                    INTERVAL hour(C.End_Time) HOUR)\nGROUP BY DATE_ADD(convert(A.End_Time, date),\n                  INTERVAL hour(A.End_Time) HOUR)\nORDER BY DATE_ADD(convert(A.End_Time, date),\n                  INTERVAL hour(End_Time) HOUR) desc;"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":1,"instance_fqid":"b5129692-92ea-4d67-9e3b-5bf5f96dae67_1"},"728f731a-d64d-4ee5-84ea-493a2399ee15":{"instance_version":1,"class_id":"com-snaplogic-snaps-binary-write","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-binary-write_3-snapsmrc405","instance_id":"728f731a-d64d-4ee5-84ea-493a2399ee15","property_map":{"info":{"notes":{"value":null},"label":{"value":"File Writer"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{}}},"settings":{"createDir":{"value":false},"writeHeader":{"value":false},"executable_during_suggest":{"value":false},"filename":{"expression":true,"value":"\"daily_docs_processed_by_classification_\" + Date.now().getMonth().toString() + \"_\" + Date.now().getDate().toString() + \"_\" + Date.now().getFullYear().toString().substring(2,4) + \".csv\""},"writeEmptyFile":{"value":false},"UserPermissionsKey":{"value":[]},"validate":{"value":false},"fileAction":{"value":"OVERWRITE"}},"output":{"output101":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"input":{"input0":{"label":{"value":"input0"},"view_type":{"value":"binary"}}}},"class_version":3,"instance_fqid":"728f731a-d64d-4ee5-84ea-493a2399ee15_1"},"888bef76-1a98-4272-b925-53e331e86b09":{"instance_id":"888bef76-1a98-4272-b925-53e331e86b09","class_id":"com-snaplogic-snaps-mysql-execute","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-mysql-execute_1-snapsmrc405","instance_version":1,"property_map":{"info":{"notes":{"value":null},"label":{"value":"MySQL - Execute"}},"view_serial":101,"account":{"account_ref":{"expression":false,"value":{"label":{"expression":false,"value":"jskrable Aurora"},"ref_class_id":{"value":"com-snaplogic-snap-api-sql-accounts-mysqldatabaseaccount"},"ref_id":{"expression":false,"value":"33acbc3d-bff7-4b21-8071-4f7c66d27651"}}}},"settings":{"autoCommit":{"value":"Use account setting"},"passThrough":{"value":true},"ignoreEmptyResult":{"value":false},"executable_during_suggest":{"value":true},"sqlStatement":{"expression":false,"value":"SELECT \n\tCONVERT(IR.End_Time, DATE) AS Date,\n\tCASE WHEN dep.failedRecords IS NULL THEN 0 ELSE dep.failedRecords END AS 'Dependent Failed Records',\n\tCASE WHEN tech.failedRecords IS NULL THEN 0 ELSE tech.failedRecords END AS 'Technical Failed Records',\n\tCASE WHEN conn.failedRecords IS NULL THEN 0 ELSE conn.failedRecords END AS 'Connectivity Failed Records',\t\n\tCASE WHEN pw.failedRecords IS NULL THEN 0 ELSE pw.failedRecords END AS 'Password Issues Failed Records',\t\n\tCASE WHEN bl.failedRecords IS NULL THEN 0 ELSE bl.failedRecords END AS 'Business Logic Failed Records',\t\n\t\n\tCASE WHEN dep.failedIntegrations IS NULL THEN 0 ELSE dep.failedIntegrations END AS 'Dependent Failed Integrations',\n\tCASE WHEN tech.failedIntegrations IS NULL THEN 0 ELSE tech.failedIntegrations END AS 'Technical Failed Integrations',\n\tCASE WHEN conn.failedIntegrations IS NULL THEN 0 ELSE conn.failedIntegrations END AS 'Connectivity Failed Integrations',\n\tCASE WHEN pw.failedIntegrations IS NULL THEN 0 ELSE pw.failedIntegrations END AS 'Password Issues Failed Integrations',\n\tCASE WHEN bl.failedIntegrations IS NULL THEN 0 ELSE bl.failedIntegrations END AS 'Business Logic Failed Integrations'\n\t\t\nFROM Integration_Run IR\n\n     LEFT JOIN (SELECT \n\t\t\tsum(A.Record_Count) AS failedRecords,\n\t\t\tcount(A.Integration_Run_ID) AS failedIntegrations,\n\t\t\tA.End_Time\n               FROM Integration_Run A\n                    INNER JOIN (SELECT\n\t\t\t\t\tDISTINCT (A.Integration_Run_ID),\n\t\t\t\t\tA.Error_Key, B.Type\n                      \tFROM Integration_Errors A\n                         INNER JOIN Error_Descriptor B\n                         ON A.Error_Key = B.Error_Key\n                      \tWHERE B.Type = 'Dependent'\n                      \tORDER BY A.Detail_Datetime ASC) B\n                    ON A.Integration_Run_ID = B.Integration_Run_ID\n                \tWHERE A.Status = 'Failed'\n                \tGROUP BY CONVERT(A.End_Time, DATE)\n\t\t\t \tORDER BY CONVERT(A.End_Time, DATE)) dep\n     ON CONVERT(IR.End_Time, DATE) = CONVERT(dep.End_Time, DATE)\n\t\n     LEFT JOIN (SELECT \n\t\t\tsum(A.Record_Count) AS failedRecords,\n\t\t\tcount(A.Integration_Run_ID) AS failedIntegrations,\n\t\t\tA.End_Time\n               FROM Integration_Run A\n                    INNER JOIN (SELECT\n\t\t\t\t\tDISTINCT (A.Integration_Run_ID),\n\t\t\t\t\tA.Error_Key, B.Type\n                      \tFROM Integration_Errors A\n                         INNER JOIN Error_Descriptor B\n                         ON A.Error_Key = B.Error_Key\n                      \tWHERE B.Type = 'Technical'\n                      \tORDER BY A.Detail_Datetime ASC) B\n                    ON A.Integration_Run_ID = B.Integration_Run_ID\n                \tWHERE A.Status = 'Failed'\n                \tGROUP BY CONVERT(A.End_Time, DATE)\n\t\t\t \tORDER BY CONVERT(A.End_Time, DATE)) tech\n     ON CONVERT(IR.End_Time, DATE) = CONVERT(tech.End_Time, DATE)\n\t   \n     LEFT JOIN (SELECT \n\t\t\tsum(A.Record_Count) AS failedRecords,\n\t\t\tcount(A.Integration_Run_ID) AS failedIntegrations,\n\t\t\tA.End_Time\n               FROM Integration_Run A\n                    INNER JOIN (SELECT\n\t\t\t\t\tDISTINCT (A.Integration_Run_ID),\n\t\t\t\t\tA.Error_Key, B.Type\n                      \tFROM Integration_Errors A\n                         INNER JOIN Error_Descriptor B\n                         ON A.Error_Key = B.Error_Key\n                      \tWHERE B.Type = 'Connectivity'\n                      \tORDER BY A.Detail_Datetime ASC) B\n                    ON A.Integration_Run_ID = B.Integration_Run_ID\n                \tWHERE A.Status = 'Failed'\n                \tGROUP BY CONVERT(A.End_Time, DATE)\n\t\t\t \tORDER BY CONVERT(A.End_Time, DATE)) conn\n     ON CONVERT(IR.End_Time, DATE) = CONVERT(conn.End_Time, DATE)\t\n\t\n     LEFT JOIN (SELECT \n\t\t\tsum(A.Record_Count) AS failedRecords,\n\t\t\tcount(A.Integration_Run_ID) AS failedIntegrations,\n\t\t\tA.End_Time\n               FROM Integration_Run A\n                    INNER JOIN (SELECT\n\t\t\t\t\tDISTINCT (A.Integration_Run_ID),\n\t\t\t\t\tA.Error_Key, B.Type\n                      \tFROM Integration_Errors A\n                         INNER JOIN Error_Descriptor B\n                         ON A.Error_Key = B.Error_Key\n                      \tWHERE B.Type = 'Password Issues'\n                      \tORDER BY A.Detail_Datetime ASC) B\n                    ON A.Integration_Run_ID = B.Integration_Run_ID\n                \tWHERE A.Status = 'Failed'\n                \tGROUP BY CONVERT(A.End_Time, DATE)\n\t\t\t \tORDER BY CONVERT(A.End_Time, DATE)) pw\n     ON CONVERT(IR.End_Time, DATE) = CONVERT(pw.End_Time, DATE)\n\t\n     LEFT JOIN (SELECT \n\t\t\tsum(A.Record_Count) AS failedRecords,\n\t\t\tcount(A.Integration_Run_ID) AS failedIntegrations,\n\t\t\tA.End_Time\n               FROM Integration_Run A\n                    INNER JOIN (SELECT\n\t\t\t\t\tDISTINCT (A.Integration_Run_ID),\n\t\t\t\t\tA.Error_Key, B.Type\n                      \tFROM Integration_Errors A\n                         INNER JOIN Error_Descriptor B\n                         ON A.Error_Key = B.Error_Key\n                      \tWHERE B.Type = 'Business Logic'\n                      \tORDER BY A.Detail_Datetime ASC) B\n                    ON A.Integration_Run_ID = B.Integration_Run_ID\n                \tWHERE A.Status = 'Failed'\n                \tGROUP BY CONVERT(A.End_Time, DATE)\n\t\t\t \tORDER BY CONVERT(A.End_Time, DATE)) bl\n     ON CONVERT(IR.End_Time, DATE) = CONVERT(bl.End_Time, DATE)\t\t\n\t   \nWHERE IR.Status = 'Failed'\nGROUP BY CONVERT(IR.End_Time, DATE)\nORDER BY CONVERT(IR.End_Time, DATE) desc;"}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_version":1,"instance_fqid":"888bef76-1a98-4272-b925-53e331e86b09_1"},"9a4e22bf-abac-44fa-9a91-bbd625ae72ad":{"instance_version":1,"class_id":"com-snaplogic-snaps-mysql-execute","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-mysql-execute_1-snapsmrc405","instance_id":"9a4e22bf-abac-44fa-9a91-bbd625ae72ad","property_map":{"info":{"notes":{"value":null},"label":{"value":"MySQL - Execute"}},"view_serial":102,"account":{"account_ref":{"expression":false,"value":{"ref_id":{"expression":false,"value":"33acbc3d-bff7-4b21-8071-4f7c66d27651"},"ref_class_id":{"value":"com-snaplogic-snap-api-sql-accounts-mysqldatabaseaccount"},"label":{"expression":false,"value":"jskrable Aurora"}}}},"settings":{"autoCommit":{"value":"Use account setting"},"passThrough":{"value":true},"ignoreEmptyResult":{"value":false},"executable_during_suggest":{"value":true},"sqlStatement":{"expression":false,"value":"SELECT CAST(A.End_Time AS DATE) as Date\n,SUM(A.Record_Count) as totalDocs\n,COUNT(A.Run_Key) as totalPipes\n,avg((CAST(A.End_Time AS TIME) - CAST(A.Start_Time AS TIME))) as totalAvgDuration\n,B.cloudDocs\n,B.cloudPipes\n,B.cloudAvgDuration\n,C.groundDocs\n,C.groundPipes\n,C.groundAvgDuration\n,D.informaticaDocs\n,D.informaticaPipes\n,D.informaticaAvgDuration\nFROM Integration_Run A\n     LEFT OUTER JOIN\n     (SELECT SUM(Record_Count) as cloudDocs,\n             COUNT(Run_Key) as cloudPipes,\n\t\t   End_Time,\n             avg((CAST(End_Time AS TIME) - CAST(Start_Time AS TIME)))\n                AS cloudAvgDuration\n      FROM Integration_Run\n      WHERE Running_Server = 'Cloud - BUDev'\n\t GROUP BY CAST(End_Time AS DATE)) B\n        ON CAST(A.End_Time AS DATE) = CAST(B.End_Time AS DATE)\n     LEFT OUTER JOIN\n     (SELECT SUM(Record_Count) as groundDocs,\n             COUNT(Run_Key) as groundPipes,\n\t\t   End_Time,\n             avg((CAST(End_Time AS TIME) - CAST(Start_Time AS TIME)))\n                AS groundAvgDuration\n      FROM Integration_Run\n      WHERE Running_Server = 'Sidekick - BUDev'\n\t GROUP BY CAST(End_Time AS DATE)) C\n        ON CAST(A.End_Time AS DATE) = CAST(C.End_Time AS DATE)\n\tLEFT OUTER JOIN\n     (SELECT SUM(Record_Count) as informaticaDocs,\n             COUNT(Run_Key) as informaticaPipes,\n\t\t   End_Time,\n             avg((CAST(End_Time AS TIME) - CAST(Start_Time AS TIME)))\n                AS informaticaAvgDuration\n      FROM Integration_Run\n      WHERE Running_Server = 'IS_DEV'\n\t GROUP BY CAST(End_Time AS DATE)) D\n        ON CAST(A.End_Time AS DATE) = CAST(D.End_Time AS DATE)\nWHERE A.Status IN ('Completed', 'Failed')\nGROUP BY CAST(A.End_Time AS DATE)\nORDER BY CAST(A.End_Time AS DATE) desc;"}},"error":{"error0":{"label":{"value":"error0"},"view_type":{"value":"document"}},"error_behavior":{"value":"fail"}},"output":{"output101":{"view_type":{"value":"document"},"label":{"value":"output0"}}}},"class_version":1,"instance_fqid":"9a4e22bf-abac-44fa-9a91-bbd625ae72ad_1"},"27b71cca-e837-4f3c-8826-e7ffe9e42c42":{"instance_id":"27b71cca-e837-4f3c-8826-e7ffe9e42c42","class_id":"com-snaplogic-snaps-transform-csvformatter","class_build_tag":"snapsmrc405","class_fqid":"com-snaplogic-snaps-transform-csvformatter_3-snapsmrc405","instance_version":1,"property_map":{"info":{"label":{"value":"CSV Formatter"}},"view_serial":100,"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"settings":{"quoteMode":{"value":"ALL"},"quoteCharacter":{"value":"\""},"writeHeader":{"value":true},"charset":{"value":"UTF-8"},"ignoreEmptyStream":{"value":false},"delimiter":{"value":","},"newlineCharacter":{"value":"LF"},"useDefinedHeader":{"value":false}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"output":{"output0":{"view_type":{"value":"binary"},"label":{"value":"output0"}}}},"class_version":3,"instance_fqid":"27b71cca-e837-4f3c-8826-e7ffe9e42c42_1"}},"org_snode_id":"58c70e0ea87b6d76b3470f3e","path":"/BUDev/projects/JackSkrable_testPull/weekly_reporting","instance_version":1,"migrate_version":"master-2517","scrub_backup":[],"create_user_id":"tsemd@bu.edu","project_snode_id":"5a32ed509dd40f002078509b","property_map":{"info":{"notes":{"value":null},"label":{"value":"weekly_reporting"},"purpose":{"value":null},"pipeline_doc_uri":{"value":null},"author":{"value":"jskrable@bu.edu"}},"input":{},"settings":{"param_table":{"value":[]},"imports":{"value":[]}},"output":{"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4_output101":{"label":{"value":"File Writer - output0"},"view_type":{"value":"document"}},"8d692fb7-6483-4cfc-9608-c4ea5c0b3083_output101":{"view_type":{"value":"document"},"label":{"value":"File Writer - output0"}},"452173e2-4a8b-406f-8751-432ecb19ab8c_output101":{"view_type":{"value":"document"},"label":{"value":"File Writer - output0"}},"728f731a-d64d-4ee5-84ea-493a2399ee15_output101":{"label":{"value":"File Writer - output0"},"view_type":{"value":"document"}}},"error":{"error_behavior":{"value":"none"}}},"render_map":{"pan_x_num":0,"default_snaplex":"58c70e13050186404b38dff2","scale_ratio":1,"detail_map":{"452173e2-4a8b-406f-8751-432ecb19ab8c":{"grid_x_int":3,"error":{},"grid_y_int":1,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"0739e737-4439-480f-a761-bc1c0b4f637f":{"grid_x_int":2,"error":{},"grid_y_int":3,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4":{"grid_x_int":3,"error":{},"grid_y_int":3,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"8d692fb7-6483-4cfc-9608-c4ea5c0b3083":{"grid_x_int":3,"error":{},"grid_y_int":4,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"28c07206-4b11-409b-a14c-f26841c8ab50":{"grid_x_int":2,"error":{},"grid_y_int":4,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"fe51e887-dfbb-469a-bfd4-ec9ddf79f685":{"grid_x_int":2,"error":{},"grid_y_int":2,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"f424d299-359c-4c5d-bf05-6aee3a88d8ed":{"grid_x_int":1,"error":{},"grid_y_int":2,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"b5129692-92ea-4d67-9e3b-5bf5f96dae67":{"grid_x_int":1,"error":{},"grid_y_int":3,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"728f731a-d64d-4ee5-84ea-493a2399ee15":{"grid_x_int":3,"error":{},"grid_y_int":2,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"888bef76-1a98-4272-b925-53e331e86b09":{"grid_x_int":1,"error":{},"grid_y_int":4,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"9a4e22bf-abac-44fa-9a91-bbd625ae72ad":{"grid_x_int":1,"error":{},"grid_y_int":1,"rot_tail_int":0,"input":{},"output":{},"rot_int":0},"27b71cca-e837-4f3c-8826-e7ffe9e42c42":{"grid_x_int":2,"error":{},"grid_y_int":1,"rot_tail_int":0,"input":{},"output":{},"rot_int":0}},"pan_y_num":0},"org_id":"58c70e0ea87b6d76b3470f3e","instance_id":"8c6e3404-78a4-482f-a9fb-1ba0fe428663","class_id":"com-snaplogic-pipeline","create_time":"2017-12-14T21:34:18.925000+00:00","instance_fqid":"8c6e3404-78a4-482f-a9fb-1ba0fe428663_1","link_map":{"link136":{"src_view_id":"output101","dst_view_id":"input0","src_id":"888bef76-1a98-4272-b925-53e331e86b09","dst_id":"28c07206-4b11-409b-a14c-f26841c8ab50"},"link135":{"src_view_id":"output0","dst_view_id":"input0","src_id":"28c07206-4b11-409b-a14c-f26841c8ab50","dst_id":"8d692fb7-6483-4cfc-9608-c4ea5c0b3083"},"link134":{"src_view_id":"output0","dst_view_id":"input0","src_id":"0739e737-4439-480f-a761-bc1c0b4f637f","dst_id":"c2e8a67d-0655-4b84-b0bf-34cdfcd48cb4"},"link133":{"src_view_id":"output101","dst_view_id":"input0","src_id":"b5129692-92ea-4d67-9e3b-5bf5f96dae67","dst_id":"0739e737-4439-480f-a761-bc1c0b4f637f"},"link117":{"src_view_id":"output101","dst_view_id":"input0","src_id":"f424d299-359c-4c5d-bf05-6aee3a88d8ed","dst_id":"fe51e887-dfbb-469a-bfd4-ec9ddf79f685"},"link106":{"src_view_id":"output101","dst_view_id":"input0","src_id":"9a4e22bf-abac-44fa-9a91-bbd625ae72ad","dst_id":"27b71cca-e837-4f3c-8826-e7ffe9e42c42"},"link105":{"src_view_id":"output0","dst_view_id":"input0","src_id":"27b71cca-e837-4f3c-8826-e7ffe9e42c42","dst_id":"452173e2-4a8b-406f-8751-432ecb19ab8c"},"link102":{"src_view_id":"output0","dst_view_id":"input0","src_id":"fe51e887-dfbb-469a-bfd4-ec9ddf79f685","dst_id":"728f731a-d64d-4ee5-84ea-493a2399ee15"}},"original":{"partition_snode_id":"58c70e0fa87b6d76b3470f45","updated_by":"tsemd@bu.edu","perms":["A","R","W","X"],"time_created":"2017-12-14T21:34:19.041000+00:00","snode_id":"5a32ee5b67ad1a001f1ce1ed","owner":"tsemd@bu.edu","path":"/BUDev/projects/JackSkrable_testPull/weekly_reporting","asset_type":"Pipeline","asset_id":"8c6e3404-78a4-482f-a9fb-1ba0fe428663","time_updated":"2017-12-14T21:34:19.041000+00:00","name":"weekly_reporting","parent_snode_id":"5a32ed509dd40f002078509b","acl":[],"metadata":{},"original":{"partition_snode_id":"58c70e0fa87b6d76b3470f45","updated_by":"tsemd@bu.edu","perms":["A","R","W","X"],"time_created":"2017-12-14T21:29:52.831000+00:00","snode_id":"5a32ed509dd40f002078509b","owner":"tsemd@bu.edu","path":"/BUDev/projects/JackSkrable_testPull","asset_type":"Dir","asset_id":null,"time_updated":"2017-12-14T21:29:52.831000+00:00","name":"JackSkrable_testPull","parent_snode_id":"58c70e0fa87b6d76b3470f45","acl":[{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"tsemd@bu.edu"}],"metadata":{},"original":{"partition_snode_id":"5a1eba684503bf001e5a19c6","updated_by":"sdelano@bu.edu","perms":["A","R","W","X"],"time_created":"2017-03-13T21:24:31.092000+00:00","snode_id":"58c70e0fa87b6d76b3470f45","owner":"sdelano1@comcast.net","path":"/BUDev/projects","asset_type":"Dir","asset_id":null,"time_updated":"2017-11-03T14:40:52.927000+00:00","name":"projects","parent_snode_id":"58c70e0ea87b6d76b3470f3e","acl":[{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"admin@snaplogic.com"},{"perms":["R"],"subject_type":"GROUP","inherit":false,"subject":"members"},{"perms":["R"],"subject_type":"USER","inherit":false,"subject":"mvyravan@bu.edu"},{"perms":["R","W","X"],"subject_type":"USER","inherit":true,"subject":"sdelano1@comcast.net"},{"perms":["R","X","W"],"subject_type":"GROUP","inherit":false,"subject":"Developers"}],"metadata":{}}}}}